:name: VexRiscv platform with a verilated CFU
:description: This script runs CFU-Playground software using a verilated Custom Function Unit.

$name?="CFU"

using sysbus
mach create $name
machine LoadPlatformDescription @platforms/cpus/verilated/litex_vexriscv_verilated_cfu.repl

$bin?=@https://dl.antmicro.com/projects/renode/verilated-cfu-test-software.elf-s_10742536-04c41fb55c3011b440a3e6eb955756268f28c151
$cfuLinux?=@https://dl.antmicro.com/projects/renode/verilated-ibex--libVtop-s_527064-bf919fbb21bc3242cbc09f05a8a8cac4037daaff

showAnalyzer uart

cpu.cfu0 SimulationFilePathLinux $cfuLinux

macro reset
"""
    sysbus LoadELF $bin
"""

runMacro $reset
